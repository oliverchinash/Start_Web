
<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>小店爆品热卖</title>

    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">

    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="icon" type="image/png" href="{{assets}}i/favicon.png">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->
    <link rel="stylesheet" href="../css/amazeui.min.css">
    <link rel="stylesheet" href="../css/dropload.css">
    <link rel="stylesheet" href="../css/basic.css">
    <link rel="stylesheet" href="../css/hotSale.css">
</head>
<body  onload = "timer()">
<div class="hotSale">
    <!----头部开始------>
    <header data-am-widget="header" class="am-header header">
        <div class="am-header-left am-header-nav">
            <a href="javascript:void(0)" class="">
                <i class="am-header-icon am-icon-angle-left am-icon-md"></i>
            </a>
        </div>
        <h1 class="am-header-title">
            <a href="javascript:void(0)">
                爆品热卖
            </a>
        </h1>
    </header>
    <!----头部结束------>
    <!-----爆品图片------>
    <div>
        <img src="../img/hotSale_tp1.png" class="am-img-responsive">
    </div>
    <!----------热卖产品列表开始----------->
    <div class="hotsale-daojishi">
        <span>热卖活动还剩:</span>
        <span id = "timer">
         </span>
    </div>
    <div class="hotSale-main">
        <ul>
            <!------产品列表1开始--------->
            <li>
                <!-------图文产品列表开始--------->
                    <div data-am-widget="list_news" class="am-list-news am-list-news-default product-list-news am-cf" >
                        <div class="am-list-news-bd">
                            <ul class="am-list">
                                <!--缩略图在标题左边-->
                                <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                                    <div class="am-u-sm-4 am-list-thumb">
                                        <a href="javascript:void(0)" class="">
                                            <img src="../img/hotSale_tp2.png" class="am-img-responsive"/>
                                        </a>
                                    </div>

                                    <div class=" am-u-sm-8 am-list-main">
                                        <h3 class="am-list-item-hd"><a href="javascript:void(0)" class="">美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L</a></h3>

                                        <div class="am-list-item-desced am-cf hotSale-main-huiyuan">
                                            <a href="" class="am-fl" style="color:#FF532B">会员可见</a>
                                            <div class="am-fr"><span style="padding-right: .5rem">限购:30</span><span>库存:400</span></div>
                                        </div>
                                        <div class="am-list-item-desced">
                                            <div class="am-fl" style="margin-top: .5rem">
                                                <input id="1" style="width:100px;" class="alignment" value="1"/>
                                            </div>
                                            <div class="am-fr" style="background-color: #CC1B23; border-radius: .3rem;padding: .3rem .5rem; color:#fff">加入购物车</div>
                                        </div>

                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                <!-------图文产品列表结束--------->
            </li>
            <!------产品列表1结束--------->

            <!------产品列表2开始--------->
            <li>
                <!-------图文产品列表开始--------->
                <div data-am-widget="list_news" class="am-list-news am-list-news-default product-list-news am-cf" >
                    <div class="am-list-news-bd">
                        <ul class="am-list">
                            <!--缩略图在标题左边-->
                            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                                <div class="am-u-sm-4 am-list-thumb">
                                    <a href="javascript:void(0)" class="">
                                        <img src="../img/hotSale_tp2.png" class="am-img-responsive"/>
                                    </a>
                                </div>

                                <div class=" am-u-sm-8 am-list-main">
                                    <h3 class="am-list-item-hd"><a href="javascript:void(0)" class="">美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L</a></h3>

                                    <div class="am-list-item-desced am-cf hotSale-main-huiyuan">
                                        <a href="" class="am-fl" style="color:#FF532B">会员可见</a>
                                        <div class="am-fr"><span style="padding-right: .5rem">限购:30</span><span>库存:400</span></div>
                                    </div>
                                    <div class="am-list-item-desced">
                                        <div class="am-fl" style="margin-top: .5rem">
                                            <input id="2" style="width:100px;" class="alignment" value="1"/>
                                        </div>
                                        <div class="am-fr" style="background-color: #CC1B23; border-radius: .3rem;padding: .3rem .5rem; color:#fff">加入购物车</div>
                                    </div>

                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-------图文产品列表结束--------->
            </li>
            <!------产品列表2结束--------->

            <!------产品列表3开始--------->
            <li>
                <!-------图文产品列表开始--------->
                <div data-am-widget="list_news" class="am-list-news am-list-news-default product-list-news am-cf" >
                    <div class="am-list-news-bd">
                        <ul class="am-list">
                            <!--缩略图在标题左边-->
                            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                                <div class="am-u-sm-4 am-list-thumb">
                                    <a href="javascript:void(0)" class="">
                                        <img src="../img/hotSale_tp2.png" class="am-img-responsive"/>
                                    </a>
                                </div>

                                <div class=" am-u-sm-8 am-list-main">
                                    <h3 class="am-list-item-hd"><a href="javascript:void(0)" class="">美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L</a></h3>

                                    <div class="am-list-item-desced am-cf hotSale-main-huiyuan">
                                        <a href="" class="am-fl" style="color:#FF532B">会员可见</a>
                                        <div class="am-fr"><span style="padding-right: .5rem">限购:30</span><span>库存:400</span></div>
                                    </div>
                                    <div class="am-list-item-desced">
                                        <div class="am-fl" style="margin-top: .5rem">
                                            <input id="3" style="width:100px;" class="alignment" value="1"/>
                                        </div>
                                        <div class="am-fr" style="background-color: #CC1B23; border-radius: .3rem;padding: .3rem .5rem; color:#fff">加入购物车</div>
                                    </div>

                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-------图文产品列表结束--------->
            </li>
            <!------产品列表3结束--------->

            <!------产品列表4开始--------->
            <li>
                <!-------图文产品列表开始--------->
                <div data-am-widget="list_news" class="am-list-news am-list-news-default product-list-news am-cf" >
                    <div class="am-list-news-bd">
                        <ul class="am-list">
                            <!--缩略图在标题左边-->
                            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                                <div class="am-u-sm-4 am-list-thumb">
                                    <a href="javascript:void(0)" class="">
                                        <img src="../img/hotSale_tp2.png" class="am-img-responsive"/>
                                    </a>
                                </div>

                                <div class=" am-u-sm-8 am-list-main">
                                    <h3 class="am-list-item-hd"><a href="javascript:void(0)" class="">美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L</a></h3>

                                    <div class="am-list-item-desced am-cf hotSale-main-huiyuan">
                                        <a href="" class="am-fl" style="color:#FF532B">会员可见</a>
                                        <div class="am-fr"><span style="padding-right: .5rem">限购:30</span><span>库存:400</span></div>
                                    </div>
                                    <div class="am-list-item-desced">
                                        <div class="am-fl" style="margin-top: .5rem">
                                            <input id="4" style="width:100px;" class="alignment" value="1"/>
                                        </div>
                                        <div class="am-fr" style="background-color: #CC1B23; border-radius: .3rem;padding: .3rem .5rem; color:#fff">加入购物车</div>
                                    </div>

                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-------图文产品列表结束--------->
            </li>
            <!------产品列表4结束--------->

            <!------产品列表5开始--------->
            <li>
                <!-------图文产品列表开始--------->
                <div data-am-widget="list_news" class="am-list-news am-list-news-default product-list-news am-cf" >
                    <div class="am-list-news-bd">
                        <ul class="am-list">
                            <!--缩略图在标题左边-->
                            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                                <div class="am-u-sm-4 am-list-thumb">
                                    <a href="javascript:void(0)" class="">
                                        <img src="../img/hotSale_tp2.png" class="am-img-responsive"/>
                                    </a>
                                </div>

                                <div class=" am-u-sm-8 am-list-main">
                                    <h3 class="am-list-item-hd"><a href="javascript:void(0)" class="">美孚 汽机油（力霸）SJ 15W40 4LSJ 15W40 4L</a></h3>

                                    <div class="am-list-item-desced am-cf">
                                        <a href="" class="am-fl" style="color:#FF532B">会员可见</a>
                                        <div class="am-fr"><span style="padding-right: .5rem">限购:30</span><span>库存:400</span></div>
                                    </div>
                                    <div class="am-list-item-desced">
                                        <div class="am-fl" style="margin-top: .5rem">
                                            <input id="5" style="width:100px;" class="alignment" value="1"/>
                                        </div>
                                        <div class="am-fr" style="background-color: #CC1B23; border-radius: .3rem;padding: .3rem .5rem; color:#fff">加入购物车</div>
                                    </div>

                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-------图文产品列表结束--------->
            </li>
            <!------产品列表5结束--------->
        </ul>
    </div>
    <!----------热卖产品列表结束----------->
</div>


<script src="../js/jquery.min.js"></script>
<script src="../js/amazeui.min.js"></script>
<script src="../js/dropload.min.js"></script>
<script src="../js/hotSale.js"></script>
<!--------上拉下拉刷新--------->
<script>
    $(function(){
        // 页数
        var page = 0;
        // 每页展示10个
        var size = 10;

        // dropload
        $(".hotSale-main").dropload({
            scrollArea : window,
            domUp : {
                domClass   : 'dropload-up',
                domRefresh : '<div class="dropload-refresh">↓下拉刷新</div>',
                domUpdate  : '<div class="dropload-update">↑释放更新</div>',
                domLoad    : '<div class="dropload-load"><span class="loading"></span>加载中.....</div>'
            },
            domDown : {
                domClass   : 'dropload-down',
                domRefresh : '<div class="dropload-refresh">↑上拉加载更多</div>',
                domLoad    : '<div class="dropload-load"><span class="loading"></span>加载中....</div>',
                domNoData: '<div class="dropload-noData">没有更多数据了</div>'
            },
            loadUpFn : function(me){
                $.ajax({
                    type: 'GET',
                    url: 'json/update.json',
                    dataType: 'json',
                    success: function(data){
                        var result = '';
                        for(var i = 0; i < data.list.length; i++){
                            result +=   '<a class="item opacity" href="'+data.list[i].link+'">'
                                +'<img src="'+data.list[i].pic+'" alt="">'
                                +'<h3>'+data.list[i].title+'</h3>'
                                +'<span class="date">'+data.list[i].date+'</span>'
                                +'</a>';
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.list').html(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                            // 重置页数，重新获取loadDownFn的数据
                            page = 0;
                            // 解锁loadDownFn里锁定的情况
                            me.unlock();
                            me.noData(false);
                        },1000);
                    },
                    error: function(xhr, type){
                        alert('Ajax error!');
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            },
            loadDownFn : function(me){
                page++;
                // 拼接HTML
                var result = '';
                $.ajax({
                    type: 'GET',
                    url: 'http://ons.me/tools/dropload/json.php?page='+page+'&size='+size,
                    dataType: 'json',
                    success: function(data){
                        var arrLen = data.length;
                        if(arrLen > 0){
                            for(var i=0; i<arrLen; i++){
                                result +=   '<a class="item opacity" href="'+data[i].link+'">'
                                    +'<img src="'+data[i].pic+'" alt="">'
                                    +'<h3>'+data[i].title+'</h3>'
                                    +'<span class="date">'+data[i].date+'</span>'
                                    +'</a>';
                            }
                            // 如果没有数据
                        }else{
                            // 锁定
                            me.lock();
                            // 无数据
                            me.noData();
                        }
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            // 插入数据到页面，放到最后面
                            $('.lists').append(result);
                            // 每次数据插入，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                        alert('Ajax error!');
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            },
            threshold : 50
        });
    });
</script>

</body>
</html>